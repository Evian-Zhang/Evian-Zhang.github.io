<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>LaTeX入门(十一)——公式</title>
<base target="_blank" />
<link rel="stylesheet" type="text/css" href="/css/article.css" />
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'] ],
        displayMath: [ ['$$','$$'] ]
    }
});
</script>
</head>
<body>
<div id="main_wrapper">
    <header id="main_header">
        <a href="/index.html">Evian Zhang's<br />naive blog</a>
        <h2>LaTeX入门(十一)——公式</h2>
    </header>
    <div id="article_body">
<p>
 终于，终于我们要进入LaTeX最著名的部分了——公式编辑。不得不说，LaTeX对数学公式的处理还是比其他软件高超得多，而我们日常看到的绝大多数排版出来的公式，也都是LaTeX的功劳。LaTeX的数学公式排版功能如此强大，也是由于其关于数学公式方面有一整套完善的框架来完成。下面我们将一点点介绍LaTeX的数学模式。
</p>
<p>
 首先，LaTeX本身自带数学公式的排版指令，但并不是十分丰富和完善。美国数学学会(American Mathematical Society, AMS)为LaTeX提供了一个宏包
 <code>
  amsmath
 </code>
 . 这个宏包是我们在进行数学方面写作的时候必须使用的宏包。因此，我们首先需要在导言区写上
</p>
<div class="highlight">
 <pre><code class="language-tex"><span></span> <span class="k">\usepackage</span><span class="nb">{</span>amsmath<span class="nb">}</span>
</code></pre>
</div>
<h2>
 行内公式与行间公式
</h2>
<p>
 总得来说，在一篇论文中，公式的表现形式有两种：行内公式与行间公式。行内公式是指与其前后上下文出现在同一行内的公式，而行间公式则是单独为一行的公式。行内公式一般并不是关键性公式，只是个别一个小步骤或者辅助性公式，而行间公式则一般是大型公式或事关键性公式。
</p>
<p>
 说了这么多，行内公式和行间公式有什么区别呢？我们来看一下一个例子：
</p>
<figure>
 <img src="56666380_assets/v2-c3a512721ac8ec35292eca298d5b9e0b_b.jpg"/>
</figure>
<p>
 在这个例子中，关于
 <span class="text/tex">
  $\displaystyle x_i$
 </span>
 的公式是行内公式，而关于
 <span class="text/tex">
  $\displaystyle y$
 </span>
 的公式是行间公式。而我的源码则是：
</p>
<div class="highlight">
 <pre><code class="language-tex"><span></span>If we let <span class="s">$</span><span class="nb">x_i</span><span class="o">=</span><span class="nv">\sum</span><span class="nb">_{j</span><span class="o">=</span><span class="m">1</span><span class="nb">}^ma_{ij}</span><span class="s">$</span>, then we can get
<span class="sb">\[</span><span class="nb"></span>
<span class="nb">y</span><span class="o">=</span><span class="nv">\sum</span><span class="nb">_{i</span><span class="o">=</span><span class="m">1</span><span class="nb">}^nx_i.</span>
<span class="s">\]</span>
</code></pre>
</div>
<p>
 这里面具体的指令我们之后再说。但我们在这里发现，
 <code>
  $...$
 </code>
 中产生的是行内公式，
 <code>
  \[...\]
 </code>
 中产生的是行间公式。对于同样的指令
 <code>
  \sum
 </code>
 ，在行内公式里，
 <span class="text/tex">
  $\displaystyle j=1$
 </span>
 和
 <span class="text/tex">
  $\displaystyle m$
 </span>
 都在它的右边，而在行间公式中，则跑到了它的上面和下面。这也是数学论文写作的规范，也就是，在行内的公式应该压缩其上下，而行间的则不用。这就是行内公式与行间公式的主要区别。
</p>
<p>
 正如上面所说，
 <code>
  $...$
 </code>
 中产生的是行内公式，
 <code>
  \[...\]
 </code>
 中产生的是行间公式。而行间公式还有许许多多的环境可以使用，这个之后会提及。那么，怎么在行内产生行间公式的效果呢？用
 <code>
  \displaystyle
 </code>
 命令。也就是，
 <code>
  $\displaystyle...$
 </code>
 其后的行内公式都会有行间公式的效果。比如说，如果我的源码变成了
</p>
<div class="highlight">
 <pre><code class="language-tex"><span></span> If we let <span class="s">$</span><span class="nv">\displaystyle</span><span class="nb"> x_i</span><span class="o">=</span><span class="nv">\sum</span><span class="nb">_{j</span><span class="o">=</span><span class="m">1</span><span class="nb">}^ma_{ij}</span><span class="s">$</span>, then we can get
<span class="sb">\[</span><span class="nb"></span>
<span class="nb">y</span><span class="o">=</span><span class="nv">\sum</span><span class="nb">_{i</span><span class="o">=</span><span class="m">1</span><span class="nb">}^nx_i.</span>
<span class="s">\]</span>
</code></pre>
</div>
<p>
 那么最终排版出来的效果是：
</p>
<figure>
 <img src="56666380_assets/v2-f32f3f6f48f2c22191fbf4138b2faa4c_b.jpg"/>
</figure>
<p>
 此外，还有针对单个运算符的改变方式，这个会在之后讲到上标与下标的时候提及。
</p>
<h2>
 数学模式
</h2>
<p>
 根据我们上面的例子，大家应该对LaTeX的数学模式有了一个大致的印象了。也就是说，在正常情况下，是文本模式，基本上就是啥都可以输入，但是不会排版出数学公式来。我如果在正常的文本模式下输入
 <code>
  \sum_{j=1}^n
 </code>
 这样的数学公式的指令，那么是会报错滴。进入数学模式，只有通过
 <code>
  $...$
 </code>
 ,
 <code>
  \[...\]
 </code>
 或者其他数学模式环境才能进入数学模式。在数学模式中，输入的都会被认作是数学公式。比如说，我如果在数学模式中输入
 <code>
  naive
 </code>
 , 排版出来的结果会是
 <span class="text/tex">
  $\displaystyle naive$
 </span>
 . 不仅字体不一样，而且其他文本信息也不一样。因为LaTeX自动会认为这是一个变量的名字。所以，除非特殊情况，否则在绝大多数情况下我们在数学模式中输入的应该只有数学公式。
</p>
<h2>
 基础的数学公式
</h2>
<p>
 下面，为了大家能尽快使用数学模式，就先给大家介绍一些基础的数学公式的指令。
</p>
<ul>
 <li>
  四则运算
  <br/>
  加法
  <code>
   +
  </code>
  , 减法
  <code>
   -
  </code>
  , 叉乘
  <code>
   \times
  </code>
  , 点乘
  <code>
   \cdot
  </code>
  , 分数
  <code>
   \frac{}{}
  </code>
  , 第一个大括号内为分子，第二个大括号内为分母
 </li>
 <li>
  指数对数
  <br/>
  指数
  <code>
   {}^{}
  </code>
  , 第一个大括号内为底数，第二个大括号内为指数；对数
  <code>
   \log_{}
  </code>
  , 大括号内为真数；根号
  <code>
   \sqrt{}
  </code>
  , 高次根号
  <code>
   \sqrt[]{}
  </code>
  , 中括号内为次数
 </li>
 <li>
  上标下标
  <br/>
  上标同指数一样
  <code>
   {}^{}
  </code>
  ，下标为
  <code>
   {}_{}
  </code>
  .
  <br/>
  这里特别提一句，在有的指令后面，
  <code>
   ^
  </code>
  和
  <code>
   _
  </code>
  不一定是上下标。比如说
  <code>
   \sum_{}^{}
  </code>
  , 在行间公式模式下，就代表正下方和正上方。如果要更改这个方式，可以用
  <code>
   \limits
  </code>
  和
  <code>
   \nolimits
  </code>
  指令。比如说，如果想让行间公式的求和符号的上下标在角上而不在上下方，可以写
  <code>
   \sum\nolimits_{}\nolimits^{}
  </code>
  , 如果想让行内公式的求和符号的上下标在上下方而不在角上，可以写
  <code>
   \sum\limits_{}\limits^{}
  </code>
  .
 </li>
 <li>
  括号
  <br/>
  如果我们直接输入
  <code>
   (
  </code>
  ,
  <code>
   )
  </code>
  这类的括号，那么会被当作一个括号字符，并不会有变化。 我们也可以用
  <code>
   \left(
  </code>
  ,
  <code>
   \right)
  </code>
  这样的命令来产生括号。具体区别是：
  <br/>
  如果我们源码是
  <code>
   (\frac{1}{2})
  </code>
  , 那么排版出来的结果是
  <span class="text/tex">
   $\displaystyle (\frac{1}{2})$
  </span>
  ; 如果我们的源码是
  <code>
   \left(\frac{1}{2}\right)
  </code>
  , 那么排版出来的结果是
  <span class="text/tex">
   $\displaystyle \left(\frac{1}{2}\right)$
  </span>
  . 也就是说，括号的大小会跟着里面的内容而变。
  <br/>
  小括号为
  <code>
   \left(...\right)
  </code>
  , 中括号为
  <code>
   \left[...\right]
  </code>
  , 大括号为
  <code>
   \left\{...\right\}
  </code>
  (这里要注意
  <code>
   {
  </code>
  和
  <code>
   }
  </code>
  前均有
  <code>
   \
  </code>
  ), 尖括号为
  <code>
   \left&lt;...\right&gt;
  </code>
  , 绝对值为
  <code>
   \left|...\right|
  </code>
  , 范数为
  <code>
   \left\|...\right\|
  </code>
  .
  <br/>
  此外，还有可能需要我们出现单边括号的情况。比如说
  <span class="text/tex">
   $\displaystyle \left.\frac{x^2}{e^x}\right|_{x=3}$
  </span>
  , 我们只需要将不需要的那半边括号用
  <code>
   \left.
  </code>
  代替即可。比如说刚刚的公式的源码就是
  <code>
   \left.\frac{x^2}{e^x}\right|_{x=3}
  </code>
  .
 </li>
 <li>
  求和与求积
  <br/>
  <span class="text/tex">
   $\displaystyle \sum_{a}^b$
  </span>
  :
  <code>
   \sum_{a}^{b}
  </code>
  ;
  <span class="text/tex">
   $\displaystyle \prod_{a}^{b}$
  </span>
  :
  <code>
   \prod_{a}^{b}
  </code>
 </li>
 <li>
  积分与微分
  <br/>
  <span class="text/tex">
   $\displaystyle \int_{a}^{b}$
  </span>
  :
  <code>
   \int_{a}^{b}
  </code>
  ;
  <span class="text/tex">
   $\displaystyle \iint_{D}$
  </span>
  :
  <code>
   \iint_{D}
  </code>
  ;
  <span class="text/tex">
   $\displaystyle \iiint_{D}$
  </span>
  :
  <code>
   \iiint_{D}
  </code>
  ;
  <span class="text/tex">
   $\displaystyle \oint_{C}$
  </span>
  :
  <code>
   \oint_{C}
  </code>
  <br/>
  此外，这个内置的积分符号如果觉得有der丑，可以使用宏包
  <code>
   esint
  </code>
  , 具体的使用指令可以用texdoc看宏包的说明文档。
  <br/>
  对于微分，有规定说
  <span class="text/tex">
   $\displaystyle \mathrm{d}x$
  </span>
  中的d一定要是直立体。因此，请在导言区加上一句：
  <br/>
  <code>
   \def\dif{\mathop{}\!{}\mathrm{d}}
  </code>
  <br/>
  然后在正文中用
  <code>
   \dif
  </code>
  代替d
  <br/>
  此外，偏微分
  <span class="text/tex">
   $\displaystyle \partial$
  </span>
  :
  <code>
   \partial
  </code>
 </li>
 <li>
  极限
  <br/>
  <span class="text/tex">
   $\displaystyle \lim_{a\to b}$
  </span>
  :
  <code>
   \limit_{a\to b}
  </code>
 </li>
</ul>
<p>
 此外，还有很多其他的符号，大家在网上都可以方便地找到。
</p>
<h2>
 数学环境
</h2>
<p>
 接下来，就介绍一些不同的数学环境。
</p>
<p>
 最基础的行间公式环境就是
 <code>
  \[...\]
 </code>
 . 这里面的公式默认居中，并且不能换行，没有编号。
</p>
<p>
 如果要添加编号，可以使用
 <code>
  equation
 </code>
 环境，即
 <code>
  \begin{equation}...\end{equation}
 </code>
 , 不过该环境依然不能换行
</p>
<p>
 能够换行的环境，最基础的是
 <code>
  gather
 </code>
 环境，即
 <code>
  \begin{gather}...\end{gather}
 </code>
 , 换行方式为
 <code>
  \\
 </code>
 断行。 该环境每行公式均居中，默认编号。其对应的不编号版本为
 <code>
  gather*
 </code>
 环境，即
 <code>
  \begin{gather*}...\end{gather*}
 </code>
 . 如果要在某一行不编号，则在该行的
 <code>
  \\
 </code>
 前加一个
 <code>
  \notag
 </code>
 .
</p>
<p>
 其次，可以用
 <code>
  align
 </code>
 环境实现换行且手动对齐。比如说有如下公式：
</p>
<p>
 <span class="text/tex">
  $\displaystyle \begin{align}f(x)&amp;=\frac{x}{x^2+2x+1}\\&amp;=\frac{1}{x+\frac{1}{x}+2}\end{align}$
 </span>
</p>
<p>
 它的源码就是
</p>
<div class="highlight">
 <pre><code class="language-tex"><span></span><span class="k">\begin</span><span class="nb">{</span>align<span class="nb">}</span>
f(x)<span class="nb">&amp;</span>=<span class="k">\frac</span><span class="nb">{</span>x<span class="nb">}{</span>x<span class="nb">^</span>2+2x+1<span class="nb">}</span><span class="k">\\</span>
<span class="nb">&amp;</span>=<span class="k">\frac</span><span class="nb">{</span>1<span class="nb">}{</span>x+<span class="k">\frac</span><span class="nb">{</span>1<span class="nb">}{</span>x<span class="nb">}</span>+2<span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>align<span class="nb">}</span>
</code></pre>
</div>
<p>
 也就是说，用
 <code>
  &amp;
 </code>
 来表示对齐。
 <br/>
 <code>
  align
 </code>
 环境是默认编号的，其对应的不编号版本为
 <code>
  align*
 </code>
 环境。
</p>
<h2>
 数学模式内的字体
</h2>
<p>
 数学模式下，LaTeX使用了不一样的字体。数学模式的字体族可以通过
 <code>
  \setmathfont{}
 </code>
 (需要使用
 <code>
  unicode-math
 </code>
 宏包)来设置。
</p>
<p>
 在数学模式下，是默认使用数学字体族的意大利斜体的。如果要使用数学字体族的直立体，可以使用
 <code>
  \mathrm{}
 </code>
 指令，使用数学字体族的粗体，可以使用
 <code>
  \mathbf{}
 </code>
 指令。如果要回到正文字体，可以使用
 <code>
  \text{}
 </code>
 指令。其中，
 <code>
  \text{}
 </code>
 指令还可以让我们在数学模式下输入中文，比如说：
</p>
<p>
 <span class="text/tex">
  $\displaystyle D(x)=\begin{cases}0&amp;x\text{是有理数}\\1&amp;x\text{是无理数}\end{cases}$
 </span>
</p>
<p>
 的源码就是
</p>
<div class="highlight">
 <pre><code class="language-text"><span></span>D(x)=\begin{cases}
0&amp;x\text{是有理数}
\\1&amp;x\text{是无理数}
\end{cases}
</code></pre>
</div>
<p>
</p></div></div></body></html>